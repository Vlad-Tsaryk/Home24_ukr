{% extends 'layout/basic.html' %}
{% block header_text %}
    Пользователь
{% endblock %}
{% block content %}
    <div class="box">
        <div class="box-body">

            <form id="w0" method="post">
                {% csrf_token %}
                <input type="hidden" name="_csrf-backend"
                       value="1WxOv4sjUOGjzHNiCoPsO-c2hOd-xai6OpRsrI_WGg2KHCv2wRsT18-tFARL1bpa02zhjUur3_B-3yfY3753WA==">
                <div class="row">
                    <div class="col-xs-12 col-md-6">
                        <div class="form-group field-useradminform-firstname">
                            <label class="control-label" for="useradminform-firstname">Имя</label>
                            {{ form.first_name }}

                            <div class="help-block"></div>
                        </div>
                        <div class="form-group field-useradminform-lastname">
                            <label class="control-label" for="useradminform-lastname">Фамилия</label>
                            {{ form.last_name }}

                            <div class="help-block"></div>
                        </div>
                        <div class="form-group field-useradminform-phone">
                            <label class="control-label" for="useradminform-phone">Телефон</label>
                            {{ form.phone }}

                            <div class="help-block"></div>
                        </div>
                    </div>

                    <div class="col-xs-12 col-md-6">
                        <div class="form-group field-useradminform-username required">
                            <label class="control-label" for="useradminform-username">Email (логин)</label>
                            {{ form.username }}

                            <div class="help-block"></div>
                        </div>
                        <div class="form-group field-useradminform-password">
                            <label class="control-label" for="useradminform-password">Пароль</label>

                            <div class="input-group">{{ form.password1 }}

                                <span class="input-group-btn">
                        <button class="btn btn-default" type="button" onclick="generatePassword('.pass-value')">
                            Сгенерировать
                        </button>
                        <button type="button" class="btn btn-primary" id="showPass">
                            <i class="fa fa-eye" aria-hidden="true"></i>
                        </button>
                    </span>
                            </div>

                            <div class="help-block"></div>
                        </div>
                        <div class="form-group field-useradminform-password2">
                            <label class="control-label" for="useradminform-password2">Повторить пароль</label>
                            {{ form.password2 }}

                            <div class="help-block"></div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12 text-right">
                        <a href="/admin/user-admin/index" class="btn btn-default">Отменить</a>
                        <button type="submit" class="btn btn-success">Сохранить</button>
                    </div>
                </div>

            </form>
            <script>
                function generatePassword(targetSelector) {
                    var pass = Math.random().toString(36).substring(4);
                    $('input' + targetSelector).val(pass);
                    $('span' + targetSelector).text(pass);
                }
            </script>
        </div>
    </div>
{% endblock %}
{% block scripts %}
    <script>
        jQuery(function ($) {
            jQuery('#w0').yiiActiveForm([{
                "id": "useradminform-firstname",
                "name": "firstname",
                "container": ".field-useradminform-firstname",
                "input": "#useradminform-firstname",
                "validate": function (attribute, value, messages, deferred, $form) {
                    yii.validation.string(value, messages, {
                        "message": "Значение «Имя» должно быть строкой.",
                        "max": 255,
                        "tooLong": "Значение «Имя» должно содержать максимум 255 символов.",
                        "skipOnEmpty": 1
                    });
                }
            }, {
                "id": "useradminform-lastname",
                "name": "lastname",
                "container": ".field-useradminform-lastname",
                "input": "#useradminform-lastname",
                "validate": function (attribute, value, messages, deferred, $form) {
                    yii.validation.string(value, messages, {
                        "message": "Значение «Фамилия» должно быть строкой.",
                        "max": 255,
                        "tooLong": "Значение «Фамилия» должно содержать максимум 255 символов.",
                        "skipOnEmpty": 1
                    });
                }
            }, {
                "id": "useradminform-phone",
                "name": "phone",
                "container": ".field-useradminform-phone",
                "input": "#useradminform-phone",
                "validate": function (attribute, value, messages, deferred, $form) {
                    yii.validation.string(value, messages, {
                        "message": "Значение «Телефон» должно быть строкой.",
                        "max": 255,
                        "tooLong": "Значение «Телефон» должно содержать максимум 255 символов.",
                        "skipOnEmpty": 1
                    });
                }
            }, {
                "id": "useradminform-username",
                "name": "username",
                "container": ".field-useradminform-username",
                "input": "#useradminform-username",
                "validate": function (attribute, value, messages, deferred, $form) {
                    yii.validation.string(value, messages, {
                        "message": "Значение «Email (логин)» должно быть строкой.",
                        "max": 255,
                        "tooLong": "Значение «Email (логин)» должно содержать максимум 255 символов.",
                        "skipOnEmpty": 1
                    });
                    yii.validation.email(value, messages, {
                        "pattern": /^[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?$/,
                        "fullPattern": /^[^@]*<[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?\.)+[a-zA-Z0-9](?:[a-zA-Z0-9-]*[a-zA-Z0-9])?>$/,
                        "allowName": false,
                        "message": "Значение «Email (логин)» не является правильным email адресом.",
                        "enableIDN": false,
                        "skipOnEmpty": 1
                    });
                    yii.validation.required(value, messages, {"message": "Необходимо заполнить «Email (логин)»."});
                }
            }, {
                "id": "useradminform-password",
                "name": "password",
                "container": ".field-useradminform-password",
                "input": "#useradminform-password",
                "validate": function (attribute, value, messages, deferred, $form) {
                    yii.validation.string(value, messages, {
                        "message": "Значение «Пароль» должно быть строкой.",
                        "min": 6,
                        "tooShort": "Значение «Пароль» должно содержать минимум 6 символов.",
                        "max": 255,
                        "tooLong": "Значение «Пароль» должно содержать максимум 255 символов.",
                        "skipOnEmpty": 1
                    });
                    if ((function (attribute, value) {
                        return $('#is_new_record').val() == '1';
                    })(attribute, value)) {
                        yii.validation.required(value, messages, {"message": "Необходимо заполнить «Пароль»."});
                    }
                }
            }, {
                "id": "useradminform-password2",
                "name": "password2",
                "container": ".field-useradminform-password2",
                "input": "#useradminform-password2",
                "validate": function (attribute, value, messages, deferred, $form) {
                    yii.validation.string(value, messages, {
                        "message": "Значение «Повторить пароль» должно быть строкой.",
                        "min": 6,
                        "tooShort": "Значение «Повторить пароль» должно содержать минимум 6 символов.",
                        "max": 255,
                        "tooLong": "Значение «Повторить пароль» должно содержать максимум 255 символов.",
                        "skipOnEmpty": 1
                    });
                    yii.validation.compare(value, messages, {
                        "operator": "==",
                        "type": "string",
                        "compareAttribute": "useradminform-password",
                        "skipOnEmpty": 1,
                        "message": "Пароли не совпадают."
                    }, $form);
                }
            }], []);
        });
    </script>
{% endblock %}